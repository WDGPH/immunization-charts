---
output:
  pdf_document:
    latex_engine: xelatex
    keep_tex: false
documentclass: article
header-includes:
  - \usepackage{amssymb}
  - \usepackage[margin=2cm, top=2cm]{geometry}
  - \usepackage{fontspec} # for default font
  - \setmainfont{Arial} # default font type
  - \usepackage{ragged2e} # improved alignment utilities
  - \usepackage{longtable} # for multi-page tables
  - \usepackage{parskip}
  - \usepackage{fancyhdr} # for custom page numbering
  - \usepackage{lastpage} # for custom page numbering
  - \pagestyle{fancy} # for custom page numbering
  - \def\arraystretch{1.3} # Adjust row height
  - \usepackage{needspace} # Section headings and longtable interaction
params:
  data: NULL
---

```{r, results='hide', echo=FALSE}
# Attach data to environment
list2env(params$data, envir = environment())
```

```{=latex}
% for custom page numbering
\fancyhf{}
\rfoot{Page \thepage\ of \pageref{LastPage}} 

% Increase header height to allow for special characters
% Adjust top margin to match.
\setlength{\headheight}{12.56488pt}.
\addtolength{\topmargin}{-0.56488pt}

% Removes the horizontal line under the header when using fancyhdr
\renewcommand{\headrulewidth}{0pt} 
```

```{r, results='asis', echo=FALSE}
# Generate LaTeX
cat(paste0("
\\chead{",school,"}

\\begin{minipage}[c]{0.35\\textwidth}
  \\includegraphics[width=6cm]{assets/logo.eps}
\\end{minipage}
\\hfill
\\begin{minipage}[c]{0.55\\textwidth}
\\raggedleft \\huge \\textbf{Overdue Immunization Letter Distribution List}
\\end{minipage}
  
\\vspace{0.25cm}

\\begin{longtable}{|llc|}
\\hline
\\textbf{LAST NAME} & \\textbf{FIRST NAME} & \\textbf{DATE OF BIRTH}\\\\
\\hline
\\endfirsthead

\\multicolumn{3}{c}{{Continuation of distribution list}} \\\\
\\hline
\\textbf{LAST NAME} & \\textbf{FIRST NAME} & \\textbf{DATE OF BIRTH}\\\\
\\hline
\\endhead

\\hline
\\multicolumn{3}{c}{{Distribution list continued on next page}} \\\\
\\endfoot

\\hline
\\multicolumn{3}{c}{{End of distribution list}} \\\\
\\endlastfoot
",
list_LaTeX,
"
\\end{longtable}
\\needspace{2cm}
\\null
\\vspace*{\\fill}
\\begin{justify}
{\\footnotesize
The information in this notice was collected under the authority of the \\textit{Health Protection and Promotion Act} in accordance with the \\textit{Municipal Freedom of Information and Protection of Privacy Act} and the \\textit{Personal Health Information Protection Act}. This information is used for the delivery of public health programs and services; the administration of the agency; and the maintenance of healthcare databases, registries and related research, in compliance with legal and regulatory requirements. Any questions about the management of this information should be addressed to the Chief Privacy Officer at 1-800-265-7293 ext. 2975 or privacy@wdgpublichealth.ca.}
\\end{justify}
"))
```